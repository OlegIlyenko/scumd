<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="compile">

	<property name="build.dir" value="build" />
	
	<property name="jgit.dir" value="depend/egit" />
	
	<property name="minasshd.dir" value="depend/minasshd" />
	
	<path id="minasshd.src.path">
		<fileset dir="${minasshd.dir}/src">
			<include name="*" />
		</fileset>
	</path>
	
	<path id="minasshd.test.src.path">
		<fileset dir="${minasshd.dir}/junit">
			<include name="*" />
		</fileset>
	</path>
	
	<path id="jgit.src.path">
		<fileset dir="${jgit.dir}/org.spearce.jgit">
			<include name="*" />
		</fileset>
		<fileset dir="${jgit.dir}/org.spearce.jgit.pgm">
			<include name="*" />
		</fileset>
	</path>
	
	<path id="jgit.test.src.path">
		<fileset dir="${jgit.dir}/org.spearce.jgit.test">
			<include name="*" />
		</fileset>
	</path>
	
	<path id="scumd.src.path">
		<fileset dir="src">
			<include name="*" />
		</fileset>
	</path>
	
	<path id="scumd.test.src.path">
		<fileset dir="junit">
			<include name="*" />
		</fileset>
	</path>
	


	<path id="build.classpath">
		<fileset dir="lib">
			<include name="*.jar" />
		</fileset>
		<filelist>
			<file name="${jgit.dir}/jgit.jar"/>
	  </filelist>
	</path>

	<target name="clean">
		<delete dir="${build.dir}" failonerror="false" />
		<mkdir dir="${build.dir}" />
	</target>
	
	<target name="build.jgit">
		<exec dir="${jgit.dir}" command="sh make_jgit.sh" />
	</target>

	<target name="compile" depends="clean, build.jgit">
		<mkdir dir="${build.dir}" />
		<javac destdir="${build.dir}" classpathref="build.classpath">
			<src refid="${minasshd.src.dir}" />
			<src path="appsrc" />
		</javac>
	</target>
	
	<target name="resources" depends="clean">
		<copy todir="${build.dir}">
			<fileset dir="dir" id="id">
		    <exclude name="**.java"/>
			</fileset>
		</copy>
	</target>

	<target name="run" depends="compile, resources">
		<java classname="com.asolutions.scmsshd.Main" >
			<classpath>
				<fileset dir="lib">
					<include name="*.jar" />
				</fileset>
				<fileset dir="${build.dir}">
					<include name="*" />
				</fileset>
			</classpath>
		</java>
	</target>

</project>
