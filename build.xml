<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="compile">

	<property name="build.dir" value="build" />
	
	<property name="jgit.dir" value="depend/egit" />
	
	<property name="minasshd.dir" value="depend/minasshd" />

	<property name="scumd.src.dir" value="src" />
	
	<path id="build.classpath">
		<fileset dir="lib">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${jgit.dir}/org.spearce.jgit/lib">
			<include name="*.jar" />
		</fileset>
		<pathelement path="${build.dir}" />
	</path>

	<target name="clean">
		<delete dir="${build.dir}" failonerror="false" />
		<mkdir dir="${build.dir}" />
	</target>
	
	<target name="build.jgit">
		<javac destdir="${build.dir}" 
					 classpathref="build.classpath"
					 srcdir="${jgit.dir}/org.spearce.jgit/src" />
	</target>
	
	<target name="build.minasshd">
		<javac destdir="${build.dir}" 
					 classpathref="build.classpath"
					 srcdir="${minasshd.dir}/src" />
	</target>
	
	<target name="build.dependencies" depends="build.jgit, build.minasshd"/>

	<target name="compile" depends="build.dependencies">
		<javac destdir="${build.dir}" 
					 classpathref="build.classpath"
					 srcdir="${scumd.src.dir}">
		</javac>
	</target>
	
	<target name="resources" depends="clean">
		<copy todir="${build.dir}">
			<fileset dir="dir" id="id">
		    <exclude name="**.java"/>
			</fileset>
		</copy>
	</target>

	<target name="run" depends="compile, resources">
		<java classname="com.asolutions.scmsshd.Main" >
			<classpath>
				<fileset dir="lib">
					<include name="*.jar" />
				</fileset>
				<fileset dir="${build.dir}">
					<include name="*" />
				</fileset>
			</classpath>
		</java>
	</target>

</project>
